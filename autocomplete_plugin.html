<html>
    <head>
        <title>Autocomplete Plugin</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/bootstrap.css" type='text/css'>
        <link rel="stylesheet" href="css/jquery-ui.min.css" type='text/css'>
        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <style>
            .autocomplete_ul .autocomplete_li:hover{
                cursor: pointer; 
                cursor: hand;
                color: #ffffff;
                background-color: #f77462;
                border-color: #f77462;
                background-image: linear-gradient(to bottom, #f77462 0%, #f5543e 100%);
                background-repeat: repeat-x;
            }

            .autocomplete_ul{
                position: absolute;
                z-index:10;
                width:97%
            }

            .autocomplete_ul .autocomplete_li{
                z-index: 1;
            }

            .autocomplete_ul .autocomplete_li:hover{
                cursor: pointer; 
                cursor: hand;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>Search</h1>
            <form class="form-horizontal" method="get" action="autocomplete_plugin.php" id="form_search">
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <br>
                            <div class="col-lg-4">
                                <input name="value" class="form-control" id="input_box" placeholder="Search" value="" autocomplete="off" type="text" style="width: 105%">
                                <ul class="list-group list-group-ae autocomplete_ul no_display" id="autocomple_ul">
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </body>
</html>
<script>

    (function($) {

        $.fn.autocomplete_v1 = function(opt) {
            var form = $(this).closest("form");
            $(this).on('input', function() {
                if ($(this).val().length > ((opt['length'] != undefined && opt['length'] != null) ? opt['length'] : 0)) {
                    if (opt['ajax'] != undefined && opt['ajax'] != null && opt['ajax'] == true) {
                        var options = call_auto_complete_ajax($(this).val());
                    } else {
                        if (opt['in'] != undefined && opt['in'] != null && !$.isEmptyObject(opt['in'])) {
                            var options = "";
                            for (var key in opt['in']) {
                                options += "<li class='list-group-item list-group-ae-item value_in cursor_hand autocomplete_li' data-key='" + key + "' data-value='"+opt["in"][key]+"'>" + $(this).val() + " in:" + opt["in"][key] + "</li>";
                            }
                        } else {
                            var options = '<li class="list-group-item list-group-ae-item value_in cursor_hand autocomplete_li">No Data found</li>';
                        }
//                        var options = "<li class='list-group-item list-group-ae-item value_in cursor_hand autocomplete_li'>" + $(this).val() + " in:Customer ID</li>";
//                        options += "<li class='list-group-item list-group-ae-item value_in cursor_hand autocomplete_li'>" + $(this).val() + " in:Customer Name</li>";
//                        options += "<li class='list-group-item list-group-ae-item value_in cursor_hand autocomplete_li'>" + $(this).val() + " in:Ad Tag ID</li>";
//                        options += "<li class='list-group-item list-group-ae-item value_in cursor_hand autocomplete_li'>" + $(this).val() + " in:Ad Tag Name</li>";
//                        options += "<li class='list-group-item list-group-ae-item value_in cursor_hand autocomplete_li'>" + $(this).val() + " in:AE ID</li>";
//                        options += "<li class='list-group-item list-group-ae-item value_in cursor_hand autocomplete_li'>" + $(this).val() + " in:AE Name</li>";
                    }
                    $('#autocomple_ul').html(options).show();
                } else {
                    $('#autocomple_ul').html("").show();
                }
            });
            var liSelected;
            $(this).keydown(function(e) {
                if ($(this).is(":focus") && $('.list-group-ae-item').is(':visible')) {
                    var li = $('.list-group-ae-item');
                    var menu = $('.list-group-ae');
                    var active = menu.find('.active');
                    var height = active.outerHeight(); //Height of <li>
                    var top = menu.scrollTop(); //Current top of scroll window
                    var menuHeight = menu[0].scrollHeight; //Full height of <ul>
                    if (e.which === 40) {
                        if (liSelected) {
                            liSelected.removeClass('active');
                            next = liSelected.next();
                            if (next.length > 0) {
                                liSelected = next.addClass('active');
                                menu.scrollTop(top + height - 1);
                            } else {
                                liSelected = li.eq(0).addClass('active');
                                menu.scrollTop(0);
                            }
                        } else {
                            liSelected = li.eq(0).addClass('active');
                        }

                    } else if (e.which === 38) {
                        if (liSelected) {
                            liSelected.removeClass('active');
                            next = liSelected.prev();
                            if (next.length > 0) {
                                liSelected = next.addClass('active');
                                menu.scrollTop(top - height + 1);
                            } else {
                                liSelected = li.last().addClass('active');
                                menu.scrollTop(menuHeight + height + 1);
                            }
                        } else {
                            liSelected = li.last().addClass('active');
                        }
                    } else if (e.which === 13) {
                        var $name = ($('.list-group-ae').find(".active").html());
                        if ($name == "" || $name == null) {
                            $(".list-group-ae").fadeOut();
                            $('#form_search').submit();
                        } else {
                            $(".list-group-ae").fadeOut();
                            add_hidden_options($('.list-group-ae').find(".active"), form);
                        }
                    } else if (e.which === 27) {
                        $(".list-group-ae").fadeOut();
                    }
                } else if ($(this).is(":focus")) {
                    if (e.which === 13 && $(this).val().length > 0) {
                        $('#form_search').submit();
                    }
                }

            });
            $(".list-group-ae").on("click", function(e) {
                var $clicked = $(e.target);
                var $name = $clicked.html();
                if ($name == "" || $name == null) {
                    $(".list-group-ae").fadeOut();
                } else {
                    $(".list-group-ae").fadeOut();
                    add_hidden_options($clicked, form);
                }
            });
            $(document).on("click", function(e) {
                var $clicked = $(e.target);
                if (!$clicked.hasClass("list-group-ae-item") && $clicked.attr("id") != "input_box") {
                    $(".list-group-ae").fadeOut();
                }
            });
            $('#form_search').bind("keypress", function(e) {
                if (e.keyCode == 13) {
                    e.preventDefault();
                    return false;
                }
            });

        };
    }(jQuery));

    function add_hidden_options(dis, form) {
        form.submit();
//        if ($(dis).data("type") == "name_email") {
//            if ($(dis).data("value") != "" || $(dis).data("value") != null) {
//                $('#name_email').val($(dis).data("value"));
//                $('#form_search').submit();
//            }
//        }
    }

    function call_auto_complete_ajax(value) {
        return '<li class="list-group-item list-group-ae-item value_in cursor_hand autocomplete_li">No Data found</li>';
    }

    $('#input_box').autocomplete_v1({"length": 2, 'ajax': false, "in": {"customer_id": "Customer ID", "customer_fullname": "Customer Name", "ad_unit_id": "Ad Tag ID", "ad_unit_name": "Ad Tag Name", "accounting_entity_id": "AE ID", "accounting_entity_name": "AE Name", "SOURCE": "Source"}});

</script>

